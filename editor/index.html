<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>RDZPiT-JSON-Editor</title>

  <link href="css/bootstrap.min.css" rel="stylesheet">
</head>

<body>
  <h1>RDZPiT-JSON-Editor</h1>

  <div class="col-md-12">
    <div class="form-group">
      <label for="comment">Input JSON:</label>
      <textarea class="form-control" rows="5" id="inputJson"></textarea>
    </div>
    <button type="button" id="convert" class="btn btn-primary">â¬‡</button>
    <hr>
    <div id="drownData">

    </div>
  </div>

  <!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
  <script src="js/jquery-3.4.1.min.js"></script>
  <!-- Include all compiled plugins (below), or include individual files as needed -->
  <script src="js/bootstrap.min.js"></script>

  <script type="text/javascript">
    $("#convert").click(() => {
      var inputJson = JSON.parse($("textarea#inputJson").val());
      console.log(inputJson);
      drawData(inputJson);
    });

    var drawData = (input) => {
      $("#appendedData").remove();
      $("#drownData").append('<div id="appendedData"></div>');
      $("#appendedData").append('<label>' + 'News' + ':</label><div id="news" class="col-md-12"></div>');
      input['news'].forEach((element, index) => {
        $("#news").append('<label>' + 'Date' + ':</label>');
        $("#news").append('<div class="input-group"><input id="currentDate' + index + '" type="text" class="form-control" value="' + element.date + '"><span class="input-group-btn"><button id="getCurrentDateClick' + index + '" class="btn btn-default" type="button">Get current date</button></span></div>');
        $("#getCurrentDateClick" + index).click(() => {
          $("#currentDate" + index).val(getCurrentDate());
        });
        // $("#news").append('<input type="text" class="form-control" value="' + element.date + '">');
        $("#news").append('<label>' + 'Header' + ':</label>');
        $("#news").append('<input type="text" class="form-control" value="' + element.header + '">');
        $("#news").append('<label>' + 'Description' + ':</label>');
        $("#news").append('<textarea class="form-control" rows="5">' + element.description + '</textarea>');
        $("#news").append('<label>' + 'Image' + ':</label>' + concatenateNewsImage(element.image));
        $("#news").append('<div class=""><hr></div>');
      });

      // Object.keys(input).forEach(function (item) {
      //   $("#appendedData").append('<label for="usr">' + item + ':</label><input type="text" class="form-control"></div>');
      //   console.log(inputJson[item]); // value
      // });
    };

    var getCurrentDate = () => {
      var today = new Date();
      var dd = String(today.getDate()).padStart(2, '0');
      var mm = String(today.getMonth() + 1).padStart(2, '0'); //January is 0!
      var yyyy = today.getFullYear();

      return dd + '.' + mm + '.' + yyyy;
    };

    var returnRemovedEscapedQuotes = (text) => {
      // return text.replace(/blue/g, "red");
    };

    var concatenateNewsImage = (image) => {
      var toReturn = '';
      if (image) {
        toReturn += '<div class="panel panel-default panel-body">';
        toReturn += '<label>' + 'URL' + ':</label><input type="text" class="form-control" value="' + image.url + '">';
        if (image.link) {
          toReturn += '<label>' + 'Link' + ':</label><input type="text" class="form-control" value="' + image.link + '">';
        }
        toReturn += '</div>';
      }

      return toReturn;
    };
  </script>
</body>

</html>